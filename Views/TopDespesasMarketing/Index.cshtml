@model IEnumerable<SEDOGv2.Models.TopDespesasMarketingViewModel>
@using SEDOGv2.Helpers;


@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LoggedIn.cshtml";
}
                      <div class="container-fluid">
                          @using (Html.BeginForm("Index", "TopDespesasMarketing", FormMethod.Post))
                          {
                              <div class="panel panel-success">
                                  <!-- Default panel contents -->
                                  <div class="row">
                                      <div class="panel-heading  text-center">
                                          <h2>
                                              @appSettings.pageName()
                                          </h2>
                                      </div>
                                  </div>


                                  <div class="col-md-12" id="divAlert">
                                      @ViewBag.Message
                                  </div>


                                  <div class="row">
                                      <div class="col-md-3 text-right">
                                          <div class="form-group">
                                              <h4>Select a type:</h4>
                                          </div>
                                      </div>
                                      <div class="col-md-2">
                                          <div class="form-group">
                                              <select class="form-control" name="tipo" id="tipo">
                                                  <option value="NAC">National</option>
                                                  <option value="INT">International</option>
                                                  <option value="GOS">Gospel</option>
                                              </select>
                                          </div>
                                      </div>

                                      <div class="col-md-3 text-right">
                                          <div class="form-group">
                                              <h4>Select a Year:</h4>
                                          </div>
                                      </div>
                                      <div class="col-md-2">
                                          <div class="form-group">
                                              <select class="form-control" name="ano" id="ano">
                                                  <option value="0">- All - </option>
                                                  @for (int ano = 0; ano <= DateTime.Now.Year - 2010; ano++)
                                                  {
                                                      <option value="@(DateTime.Now.AddYears(-ano).ToString("yyyy"))">@DateTime.Now.AddYears(-ano).ToString("yyyy")</option>
                                                  }
                                              </select>
                                          </div>
                                      </div>
                                      <div class="col-md-2">
                                          <div class="form-group">
                                              <input type="submit" name="Gerar" value="Generate" class="btn btn-default" />
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          }
                          <div class="panel panel-success panel-report">
                              <div class="row">
                                  <div class="col-md-10 text-right">
                                      Exportar para
                                  </div>
                                  <div class="col-md-1 text-center">
                                      <button type="submit" class="btn btn-default printExcel">
                                          <i class="fa fa-file-excel-o fa-4"></i>
                                      </button>
                                  </div>
                              </div>
                              <div class="row">
                                  <h2>@ViewBag.TituloReport</h2>
                                  <table class="table table-striped table-bordered table-inline tableSortPagging" cellspacing="0" width="100%">
                                      <thead>
                                          <tr>
                                              <th>Artist</th>
                                              <th>Project</th>
                                              <th>Initial Cost</th>
                                              <th>TV Action</th>
                                              <th>Press Action</th>
                                              <th>Radio Action</th>
                                              <th>Internet Action</th>
                                              <th>Other Actions</th>
                                              <th>Press Media</th>
                                              <th>TV Media</th>
                                              <th>Digital Media</th>
                                              <th>Rádio Media</th>
                                              <th>Influencer Media</th>
                                              <th>Other Media</th>
                                              <th>Video Production</th>
                                              <th>Tour Support</th>
                                              <th>Poster/Banner</th>
                                              <th>Websites</th>
                                              <th>Clipping</th>
                                              <th>Promo CD</th>
                                              <th>Mkt+Cost</th>
                                              <th>Net Sales</th>
                                              <th>Net Result</th>
                                          </tr>
                                      </thead>

                                      @foreach (var item in Model)
                                      {
                                          <tr>
                                              <td class="bold">@item.ARTISTA</td>
                                              <td class="bold">@item.PROJETO</td>
                                              <td class="bold">@String.Format("{0:N2}", item.CUSTO_INICIAL)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.ACAO_TV)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.ACAO_IMPRENSA)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.ACAO_RADIO)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.ACAO_INTERNET)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.ACAO_OUTROS)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.MIDIA_IMPRESSA)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.MIDIA_TV)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.MIDIA_DIGITAL)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.MIDIA_RADIO)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.MIDIA_INFLUENTES)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.MIDIA_OUTROS)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.PROD_VIDEO)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.APOIO_TURNE)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.POSTER_BANNER)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.WEBSITES)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.CLIPAGEM)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.CD_PROMO)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.TOT_MARKETING_E_CUSTO_INICIAL)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.TOTAL_NET_SALES)</td>
                                              <td class="bold">@String.Format("{0:N2}", item.RESULTADO_LIQUIDO)</td>
                                          </tr>
                                      }
                                  </table>
                              </div>
                          </div>
                      </div>

                      <div class="print" style="display:none">
                          <table style="width:100%;white-space:nowrap;">
                              <tr>
                                  <td colspan="22" class="left"><img src="@SEDOGv2.Controllers.ContentToPrint.ResolveServerUrl("/Content/themes/base/images/logomarca_bw.jpg", false)" width="141" height="84" style="width:141px; height:84px" /></td>
                              </tr>
                              <tr>
                                  <td colspan="22" style="text-align:center"><h2 style="text-align:center" class="bold underline">TOP Marketing Expenses</h2></td>
                              </tr>
                              <tr>
                                  <td colspan="22" style="text-align:center"><h2 style="text-align:center" class="bold underline">@ViewBag.TituloReport</h2></td>
                              </tr>
                              <tr>
                                  <td colspan="20">&nbsp;</td>
                                  <td class="bold">@DateTime.Now.ToString("MMMM").ToUpper()[0]@DateTime.Now.ToString("MMMM").Substring(1) / @DateTime.Now.Year</td>
                                  <td class="bold">@DateTime.Now.ToString("dd/MM/yyyy") às @DateTime.Now.ToString("HH:mm:ss")</td>
                              </tr>
                              <tr class="RDLast">

                                  <td class="bold">Artist</td>
                                  <td class="bold">Project</td>
                                  <td class="bold">Initial Cost</td>
                                  <td class="bold">TV Action</td>
                                  <td class="bold">Press Action</td>
                                  <td class="bold">Radio Action</td>
                                  <td class="bold">Internet Action</td>
                                  <td class="bold">Other Actions</td>
                                  <td class="bold">Press Media</td>
                                  <td class="bold">TV Media</td>
                                  <td class="bold">Digital Media</td>
                                  <td class="bold">Rádio Media</td>
                                  <td class="bold">Influencer Media</td>
                                  <td class="bold">Other Media</td>
                                  <td class="bold">Video Production</td>
                                  <td class="bold">Tour Support</td>
                                  <td class="bold">Poster/Banner</td>
                                  <td class="bold">Websites</td>
                                  <td class="bold">Clipping</td>
                                  <td class="bold">Promo CD</td>
                                  <td class="bold">Mkt+Cost</td>
                                  <td class="bold">Net Sales</td>
                                  <td class="boldright">Net Result</td>
                              </tr>

                              @foreach (var item in Model)
                              {
                                  <tr>
                                      <td  class="bold">@String.Format("{0:c}", item.ARTISTA)</td>
                                      <td  class="bold">@String.Format("{0:c}", item.PROJETO)</td>
                                      <td  class="right">@String.Format("{0:c}", item.CUSTO_INICIAL)</td>
                                      <td  class="right">@String.Format("{0:c}", item.ACAO_TV)</td>
                                      <td  class="right">@String.Format("{0:c}", item.ACAO_IMPRENSA)</td>
                                      <td  class="right">@String.Format("{0:c}", item.ACAO_RADIO)</td>
                                      <td  class="right">@String.Format("{0:c}", item.ACAO_INTERNET)</td>
                                      <td  class="right">@String.Format("{0:c}", item.ACAO_OUTROS)</td>
                                      <td  class="right">@String.Format("{0:c}", item.MIDIA_IMPRESSA)</td>
                                      <td  class="right">@String.Format("{0:c}", item.MIDIA_TV)</td>
                                      <td class="right">@String.Format("{0:c}", item.MIDIA_DIGITAL)</td>
                                      <td  class="right">@String.Format("{0:c}", item.MIDIA_RADIO)</td>
                                      <td  class="right">@String.Format("{0:c}", item.MIDIA_INFLUENTES)</td>
                                      <td  class="right">@String.Format("{0:c}", item.MIDIA_OUTROS)</td>
                                      <td  class="right">@String.Format("{0:c}", item.PROD_VIDEO)</td>
                                      <td  class="right">@String.Format("{0:c}", item.APOIO_TURNE)</td>
                                      <td  class="right">@String.Format("{0:c}", item.POSTER_BANNER)</td>
                                      <td  class="right">@String.Format("{0:c}", item.WEBSITES)</td>
                                      <td  class="right">@String.Format("{0:c}", item.CLIPAGEM)</td>
                                      <td  class="right">@String.Format("{0:c}", item.CD_PROMO)</td>
                                      <td  class="right">@String.Format("{0:c}", item.TOT_MARKETING_E_CUSTO_INICIAL)</td>
                                      <td  class="right">@String.Format("{0:c}", item.TOTAL_NET_SALES)</td>
                                      <td  class="boldright">@String.Format("{0:c}", item.RESULTADO_LIQUIDO)</td>
                                  </tr>
                              }
                          </table>
                      </div>

@using (Html.BeginForm("Index", "Print", FormMethod.Post, new { id = "printForm" }))
{
    <input type="hidden" name="PrintHtmlContent" id="PrintHtmlContent" />
    <input type="hidden" name="PrintHtmlType" id="PrintHtmlType" />
}